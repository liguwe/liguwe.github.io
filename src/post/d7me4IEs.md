
# åŠ¨æ€è§„åˆ’ç©·ä¸¾çš„ä¸¤ç§è§†è§’ï¼šä¸åŒçš„å­åºåˆ—ä¸ªæ•°


`#ç®—æ³•/åŠ¨æ€è§„åˆ’`


| LeetCode                                                                           | åŠ›æ‰£                                                                 | éš¾åº¦  |
| ---------------------------------------------------------------------------------- | ------------------------------------------------------------------ | --- |
| [115. Distinct Subsequences](https://leetcode.com/problems/distinct-subsequences/) | [115. ä¸åŒçš„å­åºåˆ—](https://leetcode.cn/problems/distinct-subsequences/) | ğŸ”´  |


## ç›®å½•
<!-- toc -->
 ## 1. å…ˆå›é¡¾ä¸‹åŠ¨æ€è§„åˆ’çš„è§£é¢˜è¦ç‚¹ 

- æ˜ç¡® `dp å‡½æ•°æˆ–æ•°ç»„`çš„å®šä¹‰ï¼Œä»`å·²çŸ¥çš„ã€ŒçŠ¶æ€ã€`ä¸­`æ¨å¯¼`å‡º`æœªçŸ¥çš„ã€ŒçŠ¶æ€ã€`
- å°±ç®— `dp å‡½æ•°/æ•°ç»„`çš„å®šä¹‰ç›¸åŒï¼Œå¦‚æœä½ ä½¿ç”¨`ä¸åŒçš„ã€Œè§†è§’ã€`è¿›è¡Œç©·ä¸¾ï¼Œæ•ˆç‡ä¹Ÿä¸è§å¾—æ˜¯ç›¸åŒçš„
	- è§æœ¬æ–‡

## 2. ä¸¤ç§ç©·ä¸¾çš„æ€è·¯ï¼ˆæ’åˆ—ç»„åˆçš„ä¸¤ä¸ªè§†è§’ï¼‰

![](https://832-1310531898.cos.ap-beijing.myqcloud.com/1b0252f2059f869dc667fb00931a7571.png)

### 2.1. çƒç›’æ¨¡å‹

å¦‚ä¸‹å›¾ï¼š

![|512](https://832-1310531898.cos.ap-beijing.myqcloud.com/7936c202a574509aca13dd0c848ab576.png)

### 2.2. è§†è§’ 1ï¼š ç›’å­çš„è§†è§‰

é€‰æ‹©ï¼š
- é€‰æ‹©å“ªä¸ªç›’å­
	- é€‰æ‹©ä¹‹åä¸èƒ½å†è¢«é€‰æ‹©

![|672](https://832-1310531898.cos.ap-beijing.myqcloud.com/45fc7d6729e977ba87c2128b01fd9543.png)

> ä¸€ç›´æ¨å¯¼ï¼Œæœ€ç»ˆç»“è®ºï¼Œå¦‚ä¸Šé¢çš„å…¬å¼

### 2.3. è§†è§’ 2ï¼šçƒçš„è§†è§’

é€‰æ‹©ï¼š
- æ”¾å…¥
- ä¸æ”¾å…¥

![|520](https://832-1310531898.cos.ap-beijing.myqcloud.com/0e5325aa3c46b849764ed679c9f13d00.png)

## 3. è¯¥é¢˜åˆ†æ

![|552](https://832-1310531898.cos.ap-beijing.myqcloud.com/a8bac35da79575b04fc5d3cad04ef71f.png)

> æ³¨æ„æ˜¯ `å­åºåˆ—`

### æš´åŠ›è§£æ³•

ä¸€ä¸ªæ€è·¯æ˜¯ï¼š `s` çš„`å­åºåˆ—`ä¸­æœ‰å¤šå°‘ä¸ª `t` , æ‰€ä»¥æ‰¾å‡ºæ‰€æœ‰çš„`å­åºåˆ—`å³å¯ï¼Œè¿™æ˜¯ä¸€ä¸ªæš´åŠ›è§£æ³•

### æ‹†è§£é—®é¢˜

æ‰€ä»¥ï¼Œè€ƒè™‘æ˜¯å¦èƒ½å¤Ÿæ‹†è§£æˆ `è§„æ¨¡æ›´å°çš„å­é—®é¢˜` ï¼Œæ‰€ä»¥ï¼Œ**æ›´å°çš„å­é—®é¢˜æ˜¯**ï¼Ÿ

`s[i..]` çš„`å­åºåˆ—`ä¸­ `t[j..]` å‡ºç°çš„æ¬¡æ•°ä¸º `dp(s, i, t, j)`

æ‰€ä»¥ï¼Œ`åŸé¢˜`æƒ³è¦çš„ç»“æœæ˜¯ `dp(s, 0, t, 0)` ï¼Œå¯å†™å¦‚ä¸‹ä»£ç ï¼š

![|504](https://832-1310531898.cos.ap-beijing.myqcloud.com/7af5e2cc42c33fc1c5b453c3c3ed63c3.png)

> å­åºåˆ—æ˜¯éœ€è¦ä¿è¯é¡ºåºçš„ï¼Œæ‰€ä»¥æ˜¯ `s[i...]` æˆ–è€… `t[j...]`

å‚è€ƒä¸Šé¢ï¼Œè¯·é—®ï¼š**ç›’å­å¤šè¿˜æ˜¯å°çƒå¤šï¼Ÿ**
- `t` ä»£è¡¨`ç›’å­`
- `s` ä»£è¡¨ `å°çƒ`

æ‰€ä»¥ï¼Œè¦åšçš„äº‹æƒ…å°±æ˜¯æŠŠ`æ‰€æœ‰ç›’å­éƒ½è£…ä¸Šä¸€ä¸ªå°çƒ`

## 4. ç›’å­çš„è§†è§’ ï¼Œ å³ `t çš„è§†è§’`

`dp(s, 0, t, 0)` å¦‚ä½•`è½¬ç§»`å‘¢ï¼Ÿ 
- ä»¥ `s = "babgbag", t = "bag"` ä¸ºä¾‹ï¼š
	- `t[0]` åœ¨ `s` ä¸­çš„ä»€ä¹ˆä½ç½® ï¼Ÿ
		- `s[0]` å’Œ `s[2]` åŠ `s[4]`
		- æ‰€ä»¥ `è½¬åŒ–ä¸ºï¼š` Â `s[0...] , s[2...] , s[4...]` Â ä¸­å‡ºç° `t[1...]` çš„ä¸ªæ•°

ä¸Šé¢çš„æè¿°`ç¿»è¯‘`æˆä»£ç å¦‚ä¸‹ï¼š

![|416](https://832-1310531898.cos.ap-beijing.myqcloud.com/43ae65d42c0ca29aaf7d83a08fdb7a15.png)

### 4.1. æœ€ç»ˆå¯æ‰§è¡Œä»£ç 

```javascript
/**
 * @param {string} s
 * @param {string} t
 * @return {number}
 */
var numDistinct = function(s, t) {
    // ::::dp(s, i, t, j) è¡¨ç¤º s[i..] ä¸­ t[j..] å‡ºç°çš„ä¸ªæ•°
    return dp(s, 0, t, 0);
};
function dp(s,i,t,j) {
    //// :::: base case 1
    if (j === t.length) {
        // t å·²ç»å…¨éƒ¨åŒ¹é…å®Œæˆ
        return 1;
    }
    // :::: base case 2
    if (s.length - i < t.length - j) {
        // s[i..] æ¯” t[j..] è¿˜çŸ­ï¼Œå¿…ç„¶æ²¡æœ‰åŒ¹é…çš„å­åºåˆ—
        return 0;
    }
    // ::::ä»£è¡¨å‡ºç°çš„æ¬¡æ•°
    let res = 0;
    // :::: åœ¨ s[i..] ä¸­å¯»æ‰¾ kï¼Œä½¿å¾— s[k] == t[j]
    for (let k = i; k < s.length; k++) {
        if (s[k] === t[j]) {
            // ç´¯åŠ ç»“æœ
            res += dp(s, k + 1, t, j + 1);
        }
    }
    return res;
}

console.log(numDistinct('rabbbit', 'rabbit')); // 3
console.log(numDistinct('babgbag', 'bag'));    // 5
```

### 4.2. å¤‡å¿˜å½•ä¼˜åŒ–

```javascript
/**
 * @param {string} s
 * @param {string} t
 * @return {number}
 */
var numDistinct = function(s, t) {
    // ::::add memo
    const memo = new Array(s.length).fill([]);
    for (let i = 0; i < s.length; i++) {
        // :::: ä¸ºä»€ä¹ˆæ˜¯ -1 ï¼Ÿï¼Ÿï¼Ÿå› ä¸ºå‚¨å­˜çš„å€¼æ˜¯ å‡ºç°æ¬¡æ•°
        memo[i] = new Array(t.length).fill(-1);
    }
    return dp(s, 0, t, 0,memo);
};
function dp(s,i,t,j,memo) {
    if (j === t.length) {
        return 1;
    }
    if (s.length - i < t.length - j) {
        return 0;
    }
    // :::: æŸ¥å¤‡å¿˜å½•é˜²æ­¢å†—ä½™è®¡ç®—
    if (memo[i][j] !== -1) {
        return memo[i][j];
    }
    let res = 0;
    for (let k = i; k < s.length; k++) {
        if (s[k] === t[j]) {
            // ç´¯åŠ ç»“æœ
            res += dp(s, k + 1, t, j + 1,memo);
        }
    }
    memo[i][j] = res;
    return res;
}

console.log(numDistinct('rabbbit', 'rabbit'));// 3
console.log(numDistinct('babgbag', 'bag')); // 5
```

## 5. ç®—æ³•å¤æ‚åº¦åˆ†æ

- å¸¦å¤‡å¿˜å½•çš„åŠ¨æ€è§„åˆ’ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦

   - = `å­é—®é¢˜çš„ä¸ªæ•°` Â * Â `å‡½æ•°æœ¬èº«çš„æ—¶é—´å¤æ‚åº¦`
   - = `ã€ŒçŠ¶æ€ã€çš„ä¸ªæ•°` Â * `å‡½æ•°æœ¬èº«çš„æ—¶é—´å¤æ‚åº¦`
   - = `O(MN) * O(M)`
   - = `O(N * M^2)`

> `M, N` åˆ†åˆ«ä»£è¡¨ `s, t` çš„é•¿åº¦ï¼Œç®—æ³•çš„`ã€ŒçŠ¶æ€ã€`å°±æ˜¯ `dp å‡½æ•°`å‚æ•° `i, j çš„ç»„åˆ`

## 6. å°çƒçš„è§†è§’ å³ `s çš„è§†è§’`

åŸé—®é¢˜æ˜¯è®¡ç®— `s[0..]` çš„æ‰€æœ‰å­åºåˆ—ä¸­ `t[0..]` å‡ºç°çš„æ¬¡æ•°

- `s[0] = t[0]ï¼Œå³èƒ½å¤ŸåŒ¹é…`ï¼Œ åˆæœ‰`ä¸¤ç§æƒ…å†µ`
	- æƒ…å†µ 1ï¼šå»åŒ¹é…ï¼š`=>` Â  Â `s[1..]` çš„æ‰€æœ‰`å­åºåˆ—`ä¸­è®¡ç®— `t[1..]` å‡ºç°çš„æ¬¡æ•°
	- æƒ…å†µ 2ï¼šä¸åŒ¹é…ï¼š`=>` Â  `s[1..]` çš„æ‰€æœ‰`å­åºåˆ—`ä¸­è®¡ç®— `t[0..]` å‡ºç°çš„æ¬¡æ•°
- `s[0] != t[0]` åœ¨ `s[1..]` çš„`å­åºåˆ—`ä¸­è®¡ç®— `t[0...]` çš„å‡ºç°æ¬¡æ•°

ç¿»è¯‘æˆä»£ç ï¼Œå³ï¼š

```javascript
/**
 *   // ::::è½¬æ€è½¬ç§»æ–¹ç¨‹å®šä¹‰ï¼š
 *    s[i..] çš„å­åºåˆ—ä¸­ t[j..] å‡ºç°çš„æ¬¡æ•°ä¸º dp(s, i, t, j)
 */
var dp = function(s, i, t, j){
    if(s[i] === t[j]){
        // åŒ¹é…ï¼Œä¸¤ç§æƒ…å†µï¼Œç´¯åŠ å…³ç³»
        // 1ã€å»åŒ¹é… j+1  
        // 2ã€ä¸å»åŒ¹é… j
        return dp(s, i + 1, t, j + 1) + dp(s, i + 1, t, j);
    } else {
        // ä¸åŒ¹é…ï¼Œåœ¨ s[i+1..] çš„å­åºåˆ—ä¸­è®¡ç®— t[j..] çš„å‡ºç°æ¬¡æ•°
        return dp(s, i + 1, t, j);
    }
}
```

> ä¸ºå•¥æ˜æ˜ `s[0]` å¯ä»¥åŒ¹é… `t[0]`ï¼Œè¿˜ä¸è®©å®ƒä¿©åŒ¹é…å‘¢ï¼Ÿä¸»è¦æ˜¯ä¸ºäº†ç»™ `s[0]` ä¹‹åçš„å…ƒç´ åŒ¹é…çš„æœºä¼š

### 6.1. å¸¦å¤‡å¿˜å½•çš„è§£æ³•

```javascript
/**
 * @param {string} s
 * @param {string} t
 * @return {number}
 */
var numDistinct = function(s, t) {
    const memo = new Array(s.length).fill([]);
    for (let i = 0; i < s.length; i++) {
        memo[i] = new Array(t.length).fill(-1);
    }
    return dp(s, 0, t, 0, memo);
};

// å®šä¹‰ï¼šs[i..] çš„å­åºåˆ—ä¸­ t[j..] å‡ºç°çš„æ¬¡æ•°ä¸º dp(s, i, t, j, memo)
var dp = function(s, i, t, j, memo) {
    // base case 1
    if (j === t.length) {
        return 1;
    }
    // base case 2
    if (s.length - i < t.length - j) {
        return 0;
    }
    // æŸ¥å¤‡å¿˜å½•é˜²æ­¢å†—ä½™è®¡ç®—
    if (memo[i][j] !== -1) {
        return memo[i][j];
    }
    let res = 0;
    // æ‰§è¡ŒçŠ¶æ€è½¬ç§»æ–¹ç¨‹
    if (s[i] === t[j]) {
        // åŒ¹é…ï¼Œä¸¤ç§æƒ…å†µï¼Œç´¯åŠ å…³ç³»
        res += dp(s, i + 1, t, j + 1, memo) + dp(s, i + 1, t, j, memo);
    } else {
        // ä¸åŒ¹é…ï¼Œåœ¨ s[i+1..] çš„å­åºåˆ—ä¸­è®¡ç®— t[j..] çš„å‡ºç°æ¬¡æ•°
        res += dp(s, i + 1, t, j, memo);
    }
    // ç»“æœå­˜å…¥å¤‡å¿˜å½•
    memo[i][j] = res;
    return res;
};

console.log(numDistinct('rabbbit', 'rabbit'));// 3
console.log(numDistinct('babgbag', 'bag')); // 5
```

### 6.2. å¤æ‚åº¦åˆ†æ

- å¸¦å¤‡å¿˜å½•çš„åŠ¨æ€è§„åˆ’ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦

   - = `å­é—®é¢˜çš„ä¸ªæ•°` Â * Â `å‡½æ•°æœ¬èº«çš„æ—¶é—´å¤æ‚åº¦`
   - = `ã€ŒçŠ¶æ€ã€çš„ä¸ªæ•°` Â * `å‡½æ•°æœ¬èº«çš„æ—¶é—´å¤æ‚åº¦`
   - = `O(MN) * O(1)`
   - = `O(N * M)`

> `M, N` åˆ†åˆ«ä»£è¡¨ `s, t` çš„é•¿åº¦ï¼Œç®—æ³•çš„`ã€ŒçŠ¶æ€ã€`å°±æ˜¯ `dp å‡½æ•°`å‚æ•° `i, j çš„ç»„åˆ`

æ˜æ˜¾æ¯”æ€§èƒ½æ›´å¥½

## 7. æ€»ç»“

å°±ç®— `dp å‡½æ•°/æ•°ç»„`çš„å®šä¹‰ç›¸åŒï¼Œå¦‚æœä½ ä½¿ç”¨ä¸åŒçš„`ã€Œè§†è§’ã€`è¿›è¡Œç©·ä¸¾ï¼Œæ•ˆç‡ä¹Ÿä¸è§å¾—æ˜¯ç›¸åŒçš„

## 8. æ€è€ƒ

é‚£ä¹ˆä¸å¦¨è¿›ä¸€æ­¥æ€è€ƒä¸€ä¸‹ï¼Œä»€ä¹ˆæ ·çš„åŠ¨æ€è§„åˆ’é¢˜ç›®å¯èƒ½äº§ç”Ÿã€Œç©·ä¸¾è§†è§’ã€ä¸Šçš„å·®å¼‚ï¼Ÿæ¢å¥è¯è¯´ï¼Œä»€ä¹ˆæ ·çš„åŠ¨æ€è§„åˆ’é—®é¢˜èƒ½å¤ŸæŠ½è±¡æˆç»å…¸çš„ã€Œçƒç›’æ¨¡å‹ã€å‘¢ï¼Ÿ

## 9. å‚è€ƒ

- [https://labuladong.github.io/algo/di-er-zhan-a01c6/dong-tai-g-a223e/dong-tai-g-2526f/](https://labuladong.github.io/algo/di-er-zhan-a01c6/dong-tai-g-a223e/dong-tai-g-2526f/)
- [https://leetcode.cn/problems/distinct-subsequences/](https://leetcode.cn/problems/distinct-subsequences/)
