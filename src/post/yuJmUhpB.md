
# äºŒå‰æœç´¢æ ‘ï¼ˆç¯‡å››ï¼šBST çš„ååºä½ç½®ï¼‰

`#BST` `#leetcode`  `#äºŒå‰æ ‘/äºŒå‰æœç´¢æ ‘`   `#2024/09/10` 

---

æœ¬æ–‡ä¼šè®²è§£ä»¥ä¸‹é¢˜ç›®ï¼š

| LeetCode                                                                                              | åŠ›æ‰£                                                                                 | éš¾åº¦  |
| ----------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------- | --- |
| [1373. Maximum Sum BST in Binary Tree](https://leetcode.com/problems/maximum-sum-bst-in-binary-tree/) | [1373. äºŒå‰æœç´¢å­æ ‘çš„æœ€å¤§é”®å€¼å’Œ](https://leetcode.cn/problems/maximum-sum-bst-in-binary-tree/) | ğŸ”´  |


## ç›®å½•
<!-- toc -->
 ## 1. é¦–å…ˆï¼Œååºæœ‰ä»€ä¹ˆç‰¹æ®Šä¹‹å¤„ï¼Ÿ 

- **å‰åº**ä½ç½®çš„ä»£ç åªèƒ½ä»**å‡½æ•°å‚æ•°**ä¸­è·å–çˆ¶èŠ‚ç‚¹ä¼ é€’æ¥çš„æ•°æ®
- è€Œ**ååº**ä½ç½®çš„ä»£ç **ä¸ä»…**å¯ä»¥è·å–å‚æ•°æ•°æ®ï¼Œ**è¿˜**å¯ä»¥æ‹¿åˆ°**å­æ ‘é€šè¿‡å‡½æ•°è¿”å›çš„å€¼**
	- ååºä½ç½®çš„ä»£ç ï¼Œæœ‰æ—¶å€™å¯ä»¥å¤§å¹…æå‡ç®—æ³•æ•ˆç‡ï¼Œæ¯”å¦‚æœ¬æ–‡éœ€è¦è®²è§£çš„é¢˜ç›®

> æ¢å¥è¯è¯´ï¼Œä¸€æ—¦ä½ å‘ç°**é¢˜ç›®å’Œå­æ ‘æœ‰å…³**ï¼Œé‚£å¤§æ¦‚ç‡è¦ç»™å‡½æ•°è®¾ç½®åˆç†çš„å®šä¹‰å’Œè¿”å›å€¼ï¼Œåœ¨ååºä½ç½®å†™ä»£ç äº†ã€‚

## 2. é¢˜ç›®åˆ†æ

é¢˜ç›®ä¼šç»™ä½ è¾“å…¥ä¸€æ£µäºŒå‰æ ‘ï¼Œè¯·ä½ æ‰¾åˆ°**èŠ‚ç‚¹ä¹‹å’Œæœ€å¤§çš„**é‚£æ£µäºŒå‰æœç´¢æ ‘ï¼Œå¹¶è¿”å›å®ƒçš„èŠ‚ç‚¹å€¼ä¹‹å’Œã€‚

![cos-blog-832-34-20241012](https://blog-1310531898.cos.ap-beijing.myqcloud.com/832-34-20241012/Pasted%20image%2020240910082418.png)

![cos-blog-832-34-20241012](https://blog-1310531898.cos.ap-beijing.myqcloud.com/832-34-20241012/Pasted%20image%2020240910082555.png)

## 3. æ€è·¯

äºŒå‰æ ‘ç›¸å…³é¢˜ç›®æœ€æ ¸å¿ƒçš„æ€è·¯æ˜¯**æ˜ç¡®å½“å‰èŠ‚ç‚¹éœ€è¦åšçš„äº‹æƒ…æ˜¯ä»€ä¹ˆ**
- â‘   å·¦å³å­æ ‘æ˜¯å¦æ˜¯ BST
- â‘¡  å·¦å­æ ‘çš„æœ€å¤§å€¼ `leftMax` å’Œå³å­æ ‘çš„æœ€å°å€¼ `rightMin`ï¼Œä¸ºäº† â‘¢ çš„åˆ¤æ–­
- â‘¢  å·¦å³å­æ ‘çš„èŠ‚ç‚¹å€¼ä¹‹å’Œ `rootSum`ï¼Œ ä¸ºäº†åˆ¤æ–­ `å·¦å³å­æ ‘+è¯¥èŠ‚ç‚¹` æ˜¯å¦æ˜¯ BST

## 4. åŸºæœ¬æ¡†æ¶

```javascript
var maxSumBST = function () {
  // å…¨å±€å˜é‡ï¼Œè®°å½• BST æœ€å¤§èŠ‚ç‚¹ä¹‹å’Œ
  var maxSum = 0;

  // éå†äºŒå‰æ ‘
  var traverse = function (root) {
    if (root === null) {
      return;
    }
    // ******* å‰åºéå†ä½ç½® *******
    // â‘  åˆ¤æ–­å·¦å³å­æ ‘æ˜¯ä¸æ˜¯ BST äºŒå‰æœç´¢æ ‘
    if (isBST(root.left) && isBST(root.right)) {
      // â‘¡ è®¡ç®—å·¦å­æ ‘çš„æœ€å¤§å€¼å’Œå³å­æ ‘çš„æœ€å°å€¼
      var leftMax = findMax(root.left);
      var rightMin = findMin(root.right);
      // â‘¢ åˆ¤æ–­ä»¥ root èŠ‚ç‚¹ä¸ºæ ¹çš„æ ‘æ˜¯ä¸æ˜¯ BST
      if (root.val > leftMax && root.val < rightMin) {
        // å¦‚æœæ¡ä»¶éƒ½ç¬¦åˆï¼Œè®¡ç®—å½“å‰ BST çš„èŠ‚ç‚¹ä¹‹å’Œ
        var leftSum = findSum(root.left);
        var rightSum = findSum(root.right);
        var rootSum = leftSum + rightSum + root.val;
        // è®¡ç®— BST èŠ‚ç‚¹çš„æœ€å¤§å’Œ
        maxSum = Math.max(maxSum, rootSum);
      }
    }
    // **************************

    // äºŒå‰æ ‘éå†æ¡†æ¶ï¼Œéå†å­æ ‘èŠ‚ç‚¹
    traverse(root.left);
    traverse(root.right);
  };

  traverse(root);
  return maxSum;
};

// è®¡ç®—ä»¥ root ä¸ºæ ¹çš„äºŒå‰æ ‘çš„æœ€å¤§å€¼
var findMax = function (root) {};

// è®¡ç®—ä»¥ root ä¸ºæ ¹çš„äºŒå‰æ ‘çš„æœ€å°å€¼
var findMin = function (root) {};

// è®¡ç®—ä»¥ root ä¸ºæ ¹çš„äºŒå‰æ ‘çš„èŠ‚ç‚¹å’Œ
var findSum = function (root) {};

// åˆ¤æ–­ä»¥ root ä¸ºæ ¹çš„äºŒå‰æ ‘æ˜¯å¦æ˜¯ BST
var isBST = function (root) {};

```

### 4.1. é—®é¢˜

è¿™å‡ ä¸ªè¾…åŠ©å‡½æ•°éƒ½æ˜¯é€’å½’å‡½æ•°ï¼Œé€’å½’é‡Œå¥—é€’å½’ï¼Œå¤æ‚åº¦æé«˜ï¼Œ`O(N^2)`

## 5. ä¼˜åŒ–

å‰åºæ”¹æˆååºï¼Œååºéå†çš„æ—¶å€™ï¼Œè®©Â `traverse`Â å‡½æ•°æŠŠè¾…åŠ©å‡½æ•°åšçš„äº‹æƒ…é¡ºä¾¿åšæ‰

```javascript
var maxSumBST = function (root) {
  // è®°å½• BST æœ€å¤§èŠ‚ç‚¹ä¹‹å’Œ
  var maxSum = 0;

  // è®¡ç®—ä»¥ root ä¸ºæ ¹çš„äºŒå‰æ ‘çš„æœ€å¤§å€¼ã€æœ€å°å€¼ã€èŠ‚ç‚¹å’Œ
  /**
   * @description è®¡ç®—ä»¥ root ä¸ºæ ¹çš„äºŒå‰æ ‘çš„ [æœ€å¤§å€¼ã€æœ€å°å€¼ã€èŠ‚ç‚¹å’Œ]
   * @param {TreeNode} root
   * @return {Array} 
   * [æ˜¯å¦ BSTï¼ˆ0 ä¸æ˜¯ï¼Œ1 æ˜¯ï¼‰, æ‰€æœ‰èŠ‚ç‚¹ä¸­çš„æœ€å°å€¼, æ‰€æœ‰èŠ‚ç‚¹ä¸­çš„æœ€å¤§å€¼, æ‰€æœ‰èŠ‚ç‚¹å€¼ä¹‹å’Œ]
   */
  var findMaxMinSum = function (root) {
    // base case
    if (root === null) {
      return [1, Number.MAX_SAFE_INTEGER, Number.MIN_SAFE_INTEGER, 0];
    }

    // é€’å½’è®¡ç®—å·¦å³å­æ ‘
    var left = findMaxMinSum(root.left);
    var right = findMaxMinSum(root.right);

    // ******* ååºéå†ä½ç½® *******
    // é€šè¿‡ left å’Œ right æ¨å¯¼è¿”å›å€¼
    // å¹¶ä¸”æ­£ç¡®æ›´æ–° maxSum å˜é‡
    var res = [0, 0, 0, 0];
    // è‹¥å·¦å³å­æ ‘éƒ½æ˜¯ BSTï¼Œä¸” root å¤§äºå·¦å­æ ‘çš„æœ€å¤§å€¼ï¼Œå°äºå³å­æ ‘çš„æœ€å°å€¼
    // åˆ™ä»¥ root ä¸ºæ ¹çš„äºŒå‰æ ‘æ˜¯ BST, æ›´æ–° res
    if (
      left[0] === 1 &&
      right[0] === 1 &&
      root.val > left[2] &&
      root.val < right[1]
    ) {
      // ä»¥ root ä¸ºæ ¹çš„äºŒå‰æ ‘æ˜¯ BST
      res[0] = 1;
      // è®¡ç®—ä»¥ root ä¸ºæ ¹çš„è¿™æ£µ BST çš„æœ€å°å€¼
      res[1] = Math.min(left[1], root.val);
      // è®¡ç®—ä»¥ root ä¸ºæ ¹çš„è¿™æ£µ BST çš„æœ€å¤§å€¼
      res[2] = Math.max(right[2], root.val);
      // è®¡ç®—ä»¥ root ä¸ºæ ¹çš„è¿™æ£µ BST æ‰€æœ‰èŠ‚ç‚¹ä¹‹å’Œ
      res[3] = left[3] + right[3] + root.val;
      // æ›´æ–°å…¨å±€å˜é‡
      maxSum = Math.max(maxSum, res[3]);
      // å¦åˆ™ï¼Œä»¥ root ä¸ºæ ¹çš„äºŒå‰æ ‘ä¸æ˜¯ BST
    } else {
      // ä»¥ root ä¸ºæ ¹çš„äºŒå‰æ ‘ä¸æ˜¯ BST
      res[0] = 0;
      // å…¶ä»–çš„å€¼éƒ½æ²¡å¿…è¦è®¡ç®—äº†ï¼Œå› ä¸ºç”¨ä¸åˆ°
    }
    return res;
  };

  findMaxMinSum(root);
  return maxSum;
};

```

### 5.1. å¤æ‚åº¦åˆ†æ

æ—¶é—´å¤æ‚åº¦åªæœ‰ `O(N)`

## 6. æœ€å

ä¸ºä»€ä¹ˆè¿™é“é¢˜ç”¨**ååºéå†**æœ‰å¥‡æ•ˆå‘¢ï¼Œå› ä¸º**æˆ‘ä»¬éœ€è¦çš„è¿™äº›å˜é‡å…¨éƒ½å¯ä»¥é€šè¿‡å­é—®é¢˜çš„ç»“æœæ¨åˆ°å‡ºæ¥**ï¼Œé€‚åˆç”¨**åˆ†è§£é—®é¢˜çš„æ€è·¯**æ±‚è§£ã€‚æ¯”å¦‚
- è®¡ç®—ä»¥Â `root`Â ä¸ºæ ¹çš„äºŒå‰æ ‘çš„èŠ‚ç‚¹ä¹‹å’Œï¼Œæ˜¯ä¸æ˜¯å¯ä»¥é€šè¿‡å·¦å³å­æ ‘çš„å’ŒåŠ ä¸ŠÂ `root.val`Â è®¡ç®—å‡ºæ¥ï¼Ÿ
- è®¡ç®—ä»¥Â `root`Â ä¸ºæ ¹çš„äºŒå‰æ ‘çš„æœ€å¤§å€¼/æœ€å°å€¼ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥é€šè¿‡å·¦å³å­æ ‘çš„æœ€å¤§å€¼/æœ€å°å€¼å’ŒÂ `root.val`Â æ¯”è¾ƒå‡ºæ¥ï¼Ÿ
- åˆ¤æ–­ä»¥Â `root`Â ä¸ºæ ¹çš„äºŒå‰æ ‘æ˜¯ä¸æ˜¯ BSTï¼Œæ˜¯ä¸æ˜¯å¾—å…ˆåˆ¤æ–­å·¦å³å­æ ‘æ˜¯ä¸æ˜¯ BSTï¼Ÿæ˜¯ä¸æ˜¯è¿˜å¾—çœ‹çœ‹å·¦å³å­æ ‘çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼Ÿ

## 7. å‚è€ƒ

https://labuladong.online/algo/data-structure/bst-part4/

