
# 前端构建提速的体系化思路


> 源于 umi 作者 CC 大佬的分享 GMTC 分享


## 目录
<!-- toc -->
 ## 1. 构建相关 5 个时代 

![图片&文件](./files/20241101-34.png)

### 1.1. 文件即scrip时代

![图片&文件](./files/20241101-35.png)

### 1.2. 大文件时代：grunt/gulp/iife

![图片&文件](./files/20241101-36.png)

### 1.3. AMD 和 CMD 时代

![图片&文件](./files/20241101-37.png)

三个问题都解决了

### 1.4. webpack 时代

![图片&文件](./files/20241101-38.png)

虽然三个问题都解决了，但新的问题又出现了

![图片&文件](./files/20241101-39.png)

举个例子

![图片&文件](./files/20241101-41.png)

不同的慢有不同的解

![图片&文件](./files/20241101-42.png)

### 1.5. esm 年代

![图片&文件](./files/20241101-43.png)

> 后面说

## 2. 构建提速的体系化思路

### 2.1. 构建每个阶段都耗时

![图片&文件](./files/20241101-44.png)

![图片&文件](./files/20241101-45.png)

### 2.2. 提速的三个思路

![图片&文件](./files/20241101-46.png)

#### 2.2.1. 缓存

![图片&文件](./files/20241101-47.png)

#### 2.2.2. 延迟处理

![图片&文件](./files/20241101-48.png)

#### 2.2.3. native code

![图片&文件](./files/20241101-49.png)

#### 2.2.4. 提速方案三个思路的应用：注意颜色

![图片&文件](./files/20241101-51.png)

### 2.3. 传统提速方案：`externals`

- `externals`：用于标记不用打包的库模块，如`JQuery、react-dom`等。可以直接通过script的方式加载

![图片&文件](./files/20241101-54.png)

![图片&文件](./files/20241101-55.png)

可用`auto externals`来解决配置复杂问题

![图片&文件](./files/20241101-56.png)

### 2.4. 传统提速方案：dll **动态链接库**

![图片&文件](./files/20241101-57.png)

![图片&文件](./files/20241101-58.png)

### 2.5. 传统提速方案：按需编译

![图片&文件](./files/20241101-61.png)

### 2.6. 传统生产优化思路

#### 2.6.1. 1、webpack构建中tree shaking

![图片&文件](./files/20241101-59.png)

#### 2.6.2. 无用抹除

可以对js/或者css做无用抹除，css需要引入包`npm i purgecss-webpack-plugin -D`

#### 2.6.3. webpack构建中 scope Hoisting

![图片&文件](./files/20241101-60.png)

### 2.7. 当代提速思路

#### 2.7.1. umi

![图片&文件](./files/20241101-62.png)

![图片&文件](./files/20241101-63.png)

#### 2.7.2. vite

![图片&文件](./files/20241101-64.png)

#### 2.7.3. umi 的 mfsu

![图片&文件](./files/20241101-65.png)

使用 Module Federation （云组件）了

![图片&文件](./files/20241101-66.png)

![图片&文件](./files/20241101-67.png)

![图片&文件](./files/20241101-68.png)

### 2.8. ESM CDN ⽅案

![图片&文件](./files/20241101-69.png)

![图片&文件](./files/20241101-70.png)

![图片&文件](./files/20241101-71.png)

## 3. 总结

![图片&文件](./files/20241101-72.png)

