
# 为什么不应该在循环、条件或嵌套函数中使用 Hooks

`#React` 


## 目录
<!-- toc -->
 ## 1. Hooks 的工作原理 

- React Hooks 依赖于`调用顺序`来维护内部状态
- 每个组件内部维护着一个 `hooks 链表`
- 每次渲染时，Hooks 都需要按照完全相同的顺序被调用

## 2. 解决方案

- 将 Hook 的调用放在组件的`最顶层`
- 使用条件渲染而不是条件式的 `Hook`
- 使用自定义 Hook 封装复杂逻辑
- 使用`数组和对象`存储多个相关状态

## 3. ESLint 规则

- 使用 `eslint-plugin-react-hooks` 可以自动检查这些问题
	- 也会检测`闭包陷阱`
- 该插件会强制执行 Hooks 的使用规则
- 推荐在项目中配置这个 ESLint 插件

## 4. 为什么这个规则这么严格

- 确保 Hook 状态的可预测性
- 保证组件的正确渲染
- 避免难以调试的问题
- 维护 React 的内部状态管理机制

## 5. 总结

- 不在循环、条件和嵌套函数中使用 Hook 的规则是为了**确保 Hooks 在每次渲染时都以相同的顺序被调用**。
- 这是 React Hooks 工作机制的**核心要求**，违反这个规则可能导致状态管理混乱、组件行为不可预测等问题。
- 通过遵守这个规则，我们可以确保组件的状态管理始终保持正确和可预测。